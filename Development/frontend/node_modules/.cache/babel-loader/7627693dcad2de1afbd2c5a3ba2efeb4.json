{"remainingRequest":"V:\\DesignWork\\PROGRAMMING\\Tools-Specific-Projects\\Javascript\\Personal Projects\\Web Apps\\ON PROGRESS\\Emotion-Based Media Player\\client\\node_modules\\babel-loader\\lib\\index.js!V:\\DesignWork\\PROGRAMMING\\Tools-Specific-Projects\\Javascript\\Personal Projects\\Web Apps\\ON PROGRESS\\Emotion-Based Media Player\\client\\node_modules\\eslint-loader\\index.js??ref--13-0!V:\\DesignWork\\PROGRAMMING\\Tools-Specific-Projects\\Javascript\\Personal Projects\\Web Apps\\ON PROGRESS\\Emotion-Based Media Player\\client\\handlers\\callback.js","dependencies":[{"path":"V:\\DesignWork\\PROGRAMMING\\Tools-Specific-Projects\\Javascript\\Personal Projects\\Web Apps\\ON PROGRESS\\Emotion-Based Media Player\\client\\handlers\\callback.js","mtime":1607309503394},{"path":"V:\\DesignWork\\PROGRAMMING\\Tools-Specific-Projects\\Javascript\\Personal Projects\\Web Apps\\ON PROGRESS\\Emotion-Based Media Player\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"V:\\DesignWork\\PROGRAMMING\\Tools-Specific-Projects\\Javascript\\Personal Projects\\Web Apps\\ON PROGRESS\\Emotion-Based Media Player\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"V:\\DesignWork\\PROGRAMMING\\Tools-Specific-Projects\\Javascript\\Personal Projects\\Web Apps\\ON PROGRESS\\Emotion-Based Media Player\\client\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmciOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJWOi9EZXNpZ25Xb3JrL1BST0dSQU1NSU5HL1Rvb2xzLVNwZWNpZmljLVByb2plY3RzL0phdmFzY3JpcHQvUGVyc29uYWwgUHJvamVjdHMvV2ViIEFwcHMvT04gUFJPR1JFU1MvRW1vdGlvbi1CYXNlZCBNZWRpYSBQbGF5ZXIvY2xpZW50L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKCi8qIGVzbGludC1kaXNhYmxlIGxpbmVicmVhay1zdHlsZSAqLwoKLyogZXNsaW50LWRpc2FibGUgbm8tY29uc29sZSAqLwoKLyogZXNsaW50LWRpc2FibGUgbGluZWJyZWFrLXN0eWxlICovCi8vIFV0aWxpdGllcwppbXBvcnQgdXNlckZldGNoIGZyb20gJ0AvY29tcG9uZW50cy9VdGlscy91c2VyRmV0Y2gnOwppbXBvcnQgcXVlcnlzdHJpbmcgZnJvbSAncXVlcnlzdHJpbmcnOwppbXBvcnQgcmVxdWVzdCBmcm9tICdyZXF1ZXN0JzsKZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY2FsbGJhY2soX3gpIHsKICByZXR1cm4gX2NhbGxiYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIF9jYWxsYmFjaygpIHsKICBfY2FsbGJhY2sgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoYXBwKSB7CiAgICB2YXIganNvbjsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiB1c2VyRmV0Y2goJ2h0dHA6Ly9sb2NhbGhvc3Q6NTAwMC9jYWxsYmFjaycpOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAganNvbiA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGpzb24pOwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjsKICAgICAgICAgICAgcmV0dXJuIGFwcC5nZXQoJy9jYWxsYmFjaycsIGZ1bmN0aW9uIChyZXEsIHJlcykgewogICAgICAgICAgICAgIC8vIGdldCBhbGwganNvbiBvYmplY3RzCiAgICAgICAgICAgICAgdmFyIFVSTCA9IGpzb24udG9rZW5fdXJsOwogICAgICAgICAgICAgIHZhciBDTElFTlRfSUQgPSBqc29uLmNsaWVudF9pZDsKICAgICAgICAgICAgICB2YXIgQ0xJRU5UX1NFQ1JFVCA9IGpzb24ucGF5bG9hZC5jbGllbnRfc2VjcmV0OwogICAgICAgICAgICAgIHZhciBSRURJUkVDVF9VUkkgPSBqc29uLnJlZGlyZWN0X3VyaTsgLy8gY29uc3QgU1RBVEVfS0VZID0ganNvbi5zdGF0ZUtleTsKCiAgICAgICAgICAgICAgdmFyIEdSQU5UX1RZUEUgPSBqc29uLmdyYW50X3R5cGU7CiAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVxLnF1ZXJ5KTsKICAgICAgICAgICAgICB2YXIgY29kZSA9IHJlcS5xdWVyeS5jb2RlIHx8IG51bGw7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coY29kZSk7CiAgICAgICAgICAgICAgdmFyIGF1dGhPcHRpb25zID0gewogICAgICAgICAgICAgICAgdXJsOiBVUkwsCiAgICAgICAgICAgICAgICBmb3JtOiB7CiAgICAgICAgICAgICAgICAgIGNvZGU6IGNvZGUsCiAgICAgICAgICAgICAgICAgIHJlZGlyZWN0X3VyaTogUkVESVJFQ1RfVVJJLAogICAgICAgICAgICAgICAgICBncmFudF90eXBlOiBHUkFOVF9UWVBFCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbmV3LWNhcAogICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmFzaWMgIi5jb25jYXQobmV3IEJ1ZmZlci5mcm9tKCIiLmNvbmNhdChDTElFTlRfSUQsICI6IikuY29uY2F0KENMSUVOVF9TRUNSRVQpKS50b1N0cmluZygnYmFzZTY0JykpCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAganNvbjogdHJ1ZQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgcmVxdWVzdC5wb3N0KGF1dGhPcHRpb25zLCBmdW5jdGlvbiAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSB7CiAgICAgICAgICAgICAgICBpZiAoIWVycm9yICYmIHJlcy5zdGF0dXNDb2RlID09PSAyMDApIHsKICAgICAgICAgICAgICAgICAgcmVzLmNvb2tpZSgnQWNjZXNzIFRva2VuJywgYm9keS5hY2Nlc3NfdG9rZW4pOwogICAgICAgICAgICAgICAgICByZXMuY29va2llKHByb2Nlc3MuZW52LlJFRlJFU0hfVE9LRU4sIGJvZHkucmVmcmVzaF90b2tlbik7CiAgICAgICAgICAgICAgICAgIHJlcy5jb29raWUocHJvY2Vzcy5lbnYuUkVGUkVTSF9DT0RFLCBjb2RlKTsgLy8gcmVkaXJlY3QgdG8gdGhlIGhvbWVwYWdlCgogICAgICAgICAgICAgICAgICByZXMucmVkaXJlY3QoJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9ob21lJyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICByZXMucmVkaXJlY3QoIi8jIi5jb25jYXQocXVlcnlzdHJpbmcuc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgICAgICBlcnJvcjogJ2ludmFsaWRfdG9rZW4nCiAgICAgICAgICAgICAgICAgIH0pKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlKTsKICB9KSk7CiAgcmV0dXJuIF9jYWxsYmFjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9"},{"version":3,"sources":["V:/DesignWork/PROGRAMMING/Tools-Specific-Projects/Javascript/Personal Projects/Web Apps/ON PROGRESS/Emotion-Based Media Player/client/handlers/callback.js"],"names":["userFetch","querystring","request","callback","app","json","console","log","get","req","res","URL","token_url","CLIENT_ID","client_id","CLIENT_SECRET","payload","client_secret","REDIRECT_URI","redirect_uri","GRANT_TYPE","grant_type","query","code","authOptions","url","form","headers","Authorization","Buffer","from","toString","post","error","response","body","statusCode","cookie","access_token","process","env","REFRESH_TOKEN","refresh_token","REFRESH_CODE","redirect","stringify"],"mappings":";;;;;;AAAA;;AACA;;AACA;AACA;AACA,OAAOA,SAAP,MAAsB,8BAAtB;AACA,OAAOC,WAAP,MAAwB,aAAxB;AACA,OAAOC,OAAP,MAAoB,SAApB;AAEA,wBAA8BC,QAA9B;AAAA;AAAA;;;sEAAe,iBAAwBC,GAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACMJ,SAAS,CAAC,gCAAD,CADf;;AAAA;AACPK,YAAAA,IADO;AAEbC,YAAAA,OAAO,CAACC,GAAR,CAAYF,IAAZ;AAFa;AAAA,mBAIPD,GAAG,CAACI,GAAJ,CAAQ,WAAR,EAAqB,UAACC,GAAD,EAAMC,GAAN,EAAc;AACvC;AACA,kBAAMC,GAAG,GAAGN,IAAI,CAACO,SAAjB;AACA,kBAAMC,SAAS,GAAGR,IAAI,CAACS,SAAvB;AACA,kBAAMC,aAAa,GAAGV,IAAI,CAACW,OAAL,CAAaC,aAAnC;AACA,kBAAMC,YAAY,GAAGb,IAAI,CAACc,YAA1B,CALuC,CAMvC;;AACA,kBAAMC,UAAU,GAAGf,IAAI,CAACgB,UAAxB;AAEAf,cAAAA,OAAO,CAACC,GAAR,CAAYE,GAAG,CAACa,KAAhB;AACA,kBAAMC,IAAI,GAAGd,GAAG,CAACa,KAAJ,CAAUC,IAAV,IAAkB,IAA/B;AACAjB,cAAAA,OAAO,CAACC,GAAR,CAAYgB,IAAZ;AACA,kBAAMC,WAAW,GAAG;AAClBC,gBAAAA,GAAG,EAAEd,GADa;AAElBe,gBAAAA,IAAI,EAAE;AACJH,kBAAAA,IAAI,EAAJA,IADI;AAEJJ,kBAAAA,YAAY,EAAED,YAFV;AAGJG,kBAAAA,UAAU,EAAED;AAHR,iBAFY;AAOlBO,gBAAAA,OAAO,EAAE;AACP;AACAC,kBAAAA,aAAa,kBAAW,IAAIC,MAAM,CAACC,IAAX,WAAmBjB,SAAnB,cAAgCE,aAAhC,GAAiDgB,QAAjD,CAA0D,QAA1D,CAAX;AAFN,iBAPS;AAWlB1B,gBAAAA,IAAI,EAAE;AAXY,eAApB;AAcAH,cAAAA,OAAO,CAAC8B,IAAR,CAAaR,WAAb,EAA0B,UAACS,KAAD,EAAQC,QAAR,EAAkBC,IAAlB,EAA2B;AACnD,oBAAI,CAACF,KAAD,IAAUvB,GAAG,CAAC0B,UAAJ,KAAmB,GAAjC,EAAsC;AACpC1B,kBAAAA,GAAG,CAAC2B,MAAJ,CAAW,cAAX,EAA2BF,IAAI,CAACG,YAAhC;AACA5B,kBAAAA,GAAG,CAAC2B,MAAJ,CAAWE,OAAO,CAACC,GAAR,CAAYC,aAAvB,EAAsCN,IAAI,CAACO,aAA3C;AACAhC,kBAAAA,GAAG,CAAC2B,MAAJ,CAAWE,OAAO,CAACC,GAAR,CAAYG,YAAvB,EAAqCpB,IAArC,EAHoC,CAKpC;;AACAb,kBAAAA,GAAG,CAACkC,QAAJ,CAAa,4BAAb;AACD,iBAPD,MAOO;AACLlC,kBAAAA,GAAG,CAACkC,QAAJ,aAAkB3C,WAAW,CAAC4C,SAAZ,CAAsB;AAAEZ,oBAAAA,KAAK,EAAE;AAAT,mBAAtB,CAAlB;AACD;AACF,eAXD;AAYD,aAtCK,CAJO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G","sourcesContent":["/* eslint-disable linebreak-style */\r\n/* eslint-disable no-console */\r\n/* eslint-disable linebreak-style */\r\n// Utilities\r\nimport userFetch from '@/components/Utils/userFetch';\r\nimport querystring from 'querystring';\r\nimport request from 'request';\r\n\r\nexport default async function callback(app) {\r\n  const json = await userFetch('http://localhost:5000/callback');\r\n  console.log(json);\r\n\r\n  await app.get('/callback', (req, res) => {\r\n    // get all json objects\r\n    const URL = json.token_url;\r\n    const CLIENT_ID = json.client_id;\r\n    const CLIENT_SECRET = json.payload.client_secret;\r\n    const REDIRECT_URI = json.redirect_uri;\r\n    // const STATE_KEY = json.stateKey;\r\n    const GRANT_TYPE = json.grant_type;\r\n\r\n    console.log(req.query);\r\n    const code = req.query.code || null;\r\n    console.log(code);\r\n    const authOptions = {\r\n      url: URL,\r\n      form: {\r\n        code,\r\n        redirect_uri: REDIRECT_URI,\r\n        grant_type: GRANT_TYPE,\r\n      },\r\n      headers: {\r\n        // eslint-disable-next-line new-cap\r\n        Authorization: `Basic ${new Buffer.from(`${CLIENT_ID}:${CLIENT_SECRET}`).toString('base64')}`,\r\n      },\r\n      json: true,\r\n    };\r\n\r\n    request.post(authOptions, (error, response, body) => {\r\n      if (!error && res.statusCode === 200) {\r\n        res.cookie('Access Token', body.access_token);\r\n        res.cookie(process.env.REFRESH_TOKEN, body.refresh_token);\r\n        res.cookie(process.env.REFRESH_CODE, code);\r\n\r\n        // redirect to the homepage\r\n        res.redirect('http://localhost:8080/home');\r\n      } else {\r\n        res.redirect(`/#${querystring.stringify({ error: 'invalid_token' })}`);\r\n      }\r\n    });\r\n  });\r\n}\r\n"]}]}